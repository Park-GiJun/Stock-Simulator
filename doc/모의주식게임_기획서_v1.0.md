# 📋 모의 주식 게임 기획서 (v1.0)

## 1. 프로젝트 개요

| 항목 | 내용 |
|------|------|
| 프로젝트명 | (미정) |
| 목적 | AI 기반 이벤트 + 수급 기반 주가 변동 모의 주식 시뮬레이션 |
| 대상 | 주식 투자 학습/체험 목적 사용자 |
| 시간 체계 | 1:4 가속 (현실 1시간 = 게임 4시간) |
| 장 운영 | 게임 내 12시간 (현실 3시간 사이클) |
| 게임 방식 | 시즌제 (기간 미정) |

---

## 2. 시간 체계

### 2.1 가속 비율 (1:4)

| 현실 시간 | 게임 시간 |
|----------|----------|
| 15분 | 1시간 |
| 1시간 | 4시간 |
| 3시간 | 12시간 (장 마감) |
| 6시간 | 1일 |
| 42시간 (~1.75일) | 1주일 (개인 주급 지급) |
| ~7.5일 | 1달 |
| ~3달 | 1년 |

### 2.2 장 운영

- 게임 시간 09:00 ~ 21:00 (12시간)
- 현실 기준 3시간마다 장 마감
- 서버 24시간 운영 시 하루 8사이클

---

## 3. 경제 밸런스

### 3.1 자본금 구조

| 구분 | 초기 자본금 | 정기 수입 | 수입 주기 |
|------|-----------|----------|----------|
| 유저 | 500만원 | - | - |
| 개인 NPC | 20만원 ~ 1억원 | 자본금의 5% | 주급 (게임 1주일) |
| 기관 | 10억원 ~ 1조원 | 자본금의 1% | 일급 (게임 1일) |

### 3.2 시가총액 등급

| 등급 | 시가총액 | 종목 수 (예상) |
|------|---------|---------------|
| SMALL | ~100억 | 200 |
| MID | ~1,000억 | 200 |
| LARGE | ~1조 | 100 |

### 3.3 초기 물량 분배

- 시즌 시작 시 기관/개인 NPC에게 랜덤 물량 배분
- 호가창 초기 유동성 확보

---

## 4. 주식 시스템 (500개)

### 4.1 산업 카테고리

| 카테고리 | 종목 수 | 특성 |
|----------|--------|------|
| IT | 72 | 고변동성, 고성장 |
| 농경 | 71 | 저변동성, 계절 민감 |
| 제조업 | 72 | 중변동성, 경기 민감 |
| 서비스업 | 72 | 중변동성, 안정적 |
| 부동산 | 71 | 저변동성, 금리 민감 |
| 럭셔리 | 71 | 고변동성, 경기 민감 |
| 식료 | 71 | 저변동성, 방어주 |

### 4.2 주식 Status Table

| 파라미터 | 타입 | 설명 | 범위/예시 |
|----------|------|------|----------|
| stockId | String | 종목 ID | "STK001" |
| stockName | String | 종목명 | "테크놀로지" |
| sector | Enum | 산업 | IT/AGRICULTURE/MANUFACTURING/SERVICE/REALESTATE/LUXURY/FOOD |
| basePrice | Long | 기준가 | 1,000 ~ 1,000,000 |
| currentPrice | Long | 현재가 | 실시간 |
| totalShares | Long | 발행주식수 | 시총 기반 계산 |
| marketCapGrade | Enum | 시총 등급 | SMALL/MID/LARGE |
| volatility | Double | 변동성 | 0.1 ~ 2.0 |
| per | Double | PER | 5 ~ 100 |
| dividendRate | Double | 배당률 | 0.0 ~ 0.1 |
| growthRate | Double | 성장률 | -0.2 ~ 0.5 |
| eventSensitivity | Double | 이벤트 민감도 | 0.5 ~ 2.0 |

---

## 5. 호가 & 체결 시스템

### 5.1 호가 단위

| 주가 범위 | 호가 단위 |
|----------|----------|
| ~1,000원 | 1원 |
| ~5,000원 | 5원 |
| ~10,000원 | 10원 |
| ~50,000원 | 50원 |
| ~100,000원 | 100원 |
| ~500,000원 | 500원 |
| 500,000원~ | 1,000원 |

### 5.2 체결 규칙

- 주문 방식: 시장가
- 우선순위: 가격 우선 → 시간 우선

### 5.3 체결에 의한 주가 변동

```
변동률 = (체결금액 / 시가총액) × volatility × direction

- 체결금액 = 체결가 × 체결수량
- 시가총액 = 현재가 × 발행주식수  
- volatility = 종목별 변동성 파라미터
- direction = 매수: +1, 매도: -1
```

---

## 6. 투자자 시스템

### 6.1 기관 투자자 (10개)

| 성향 | 수량 | 선호 종목 | 거래 빈도 |
|------|------|----------|----------|
| 공격형 (AGGRESSIVE) | 3 | 고변동성, 성장주 | HIGH |
| 안정형 (STABLE) | 4 | 저변동성, 배당주 | LOW |
| 가치투자형 (VALUE) | 3 | 저PER, 저평가 | MEDIUM |

#### 기관 파라미터

| 파라미터 | 타입 | 설명 |
|----------|------|------|
| institutionId | String | 기관 ID |
| name | String | 기관명 |
| investmentStyle | Enum | AGGRESSIVE/STABLE/VALUE |
| capital | Long | 자본금 (10억~1조) |
| dailyIncome | Long | 일급 (자본금의 1%) |
| riskTolerance | Double | 위험 허용도 (0~1) |
| preferredSectors | List\<Sector\> | 선호 산업 |
| avoidSectors | List\<Sector\> | 기피 산업 |
| rebalancingCycle | Int | 리밸런싱 주기 (게임일) |
| maxPositionRatio | Double | 종목당 최대 비중 |
| tradingFrequency | Enum | HIGH/MEDIUM/LOW |

### 6.2 개인 NPC (1,000명)

| 성향 | 비율 | 특징 |
|------|------|------|
| 공격형 | 25% | 추격매수, 단타 |
| 안정형 | 35% | 장기보유, 배당 |
| 가치투자형 | 20% | 저평가 매수 |
| 랜덤형 | 20% | 예측 불가 |

#### 개인 파라미터

| 파라미터 | 타입 | 설명 |
|----------|------|------|
| npcId | String | NPC ID |
| investmentStyle | Enum | AGGRESSIVE/STABLE/VALUE/RANDOM |
| capital | Long | 자본금 (20만~1억) |
| weeklySalary | Long | 주급 (자본금의 5%) |
| riskTolerance | Double | 위험 허용도 |
| preferredSectors | List\<Sector\> | 선호 산업 |
| rebalancingCycle | Int | 리밸런싱 주기 |
| tradingFrequency | Enum | HIGH/MEDIUM/LOW |
| fomo | Double | 추격매수 성향 (0~1) |
| panicSell | Double | 공포매도 성향 (0~1) |

### 6.3 유저 (플레이어)

| 파라미터 | 타입 | 설명 |
|----------|------|------|
| userId | String | 유저 ID |
| username | String | 닉네임 |
| email | String | 이메일 |
| password | String | 비밀번호 (암호화) |
| capital | Long | 보유 현금 |
| initialCapital | Long | 초기 자본금 (500만) |
| createdAt | DateTime | 가입일 |

---

## 7. 이벤트 시스템

### 7.1 이벤트 레벨

| 레벨 | 영향 범위 | 발생 빈도 | 강도 범위 |
|------|----------|----------|----------|
| SOCIETY | 전체 시장 | 낮음 | 0.5 ~ 2.0 |
| INDUSTRY | 특정 산업 | 중간 | 0.3 ~ 1.5 |
| COMPANY | 개별 종목 | 높음 | 0.1 ~ 1.0 |

### 7.2 이벤트 구조

| 파라미터 | 타입 | 설명 |
|----------|------|------|
| eventId | String | 이벤트 ID |
| level | Enum | SOCIETY/INDUSTRY/COMPANY |
| targetSector | Sector | 대상 산업 (INDUSTRY) |
| targetStockId | String | 대상 종목 (COMPANY) |
| sentiment | Enum | POSITIVE/NEGATIVE/NEUTRAL |
| intensity | Double | 영향 강도 |
| duration | Long | 지속 시간 (게임 분) |
| headline | String | 뉴스 헤드라인 |
| content | String | 뉴스 본문 |
| createdAt | DateTime | 발생 시각 |

### 7.3 이벤트에 의한 주가 변동

```
변동률 = intensity × eventSensitivity × sentimentMultiplier

- sentimentMultiplier: POSITIVE=+1, NEGATIVE=-1, NEUTRAL=0
- 산업 이벤트: 해당 산업 전 종목에 적용
- 사회 이벤트: 전 종목에 적용 (산업별 가중치 차등)
```

---

## 8. 시즌 & 랭킹

### 8.1 시즌 구조

| 항목 | 내용 |
|------|------|
| 시즌 기간 | 미정 (추후 결정) |
| 시즌 종료 시 | 랭킹 확정, 기록 저장 |
| 리셋 대상 | 자산, 포트폴리오, 주가 |
| 유지 대상 | 유저 계정, 시즌 히스토리 |

### 8.2 랭킹 종류

| 랭킹 | 산출 기준 |
|------|----------|
| 수익률 | (현재자산 - 초기자산) / 초기자산 × 100 |
| 총자산 | 현금 + 보유주식 평가금액 |
| 거래왕 | 총 거래대금 |

---

## 9. 시스템 아키텍처

### 9.1 전체 구조

```
                         ┌─────────────────┐
                         │    Frontend     │
                         │   (SvelteKit)   │
                         └────────┬────────┘
                                  │ HTTP / WebSocket
                         ┌────────▼────────┐
                         │   API Gateway   │
                         └────────┬────────┘
                                  │
                    ┌─────────────▼─────────────┐
                    │     Eureka Discovery      │
                    └─────────────┬─────────────┘
                                  │
   ┌────────┬────────┬───────────┼───────────┬────────┬────────┐
   ▼        ▼        ▼           ▼           ▼        ▼        ▼
┌──────┐┌──────┐┌───────┐┌───────────┐┌──────┐┌──────┐┌──────┐
│Stock ││Trade ││ Event ││ Scheduler ││ User ││ News ││Season│
│ Svc  ││ Svc  ││  Svc  ││    Svc    ││ Svc  ││ Svc  ││ Svc  │
└──────┘└──────┘└───────┘└───────────┘└──────┘└──────┘└──────┘
```

### 9.2 서비스 상세

| 서비스 | 역할 | 주요 DB | Kafka 역할 |
|--------|------|---------|-----------|
| Stock Service | 종목 정보, 시세, 호가창 | Redis, PostgreSQL | Consumer |
| Trading Service | 주문, 체결, 잔고 | PostgreSQL | Producer/Consumer |
| Event Service | 이벤트 생성, 영향 계산 | MongoDB | Producer |
| Scheduler Service | 기관/개인 자동투자 | - | Producer |
| User Service | 인증, 유저 관리 | PostgreSQL | - |
| News Service | 뉴스 저장/조회/검색 | MongoDB, Elasticsearch | Consumer |
| Season Service | 시즌 관리, 랭킹 | PostgreSQL, Redis | Consumer |

### 9.3 데이터 저장소 역할

| 저장소 | 용도 |
|--------|------|
| PostgreSQL | 유저, 주식 마스터, 거래내역, 잔고, 시즌, 랭킹 |
| MongoDB | 이벤트 로그, 뉴스, NPC 행동 로그 |
| Redis | 실시간 시세, 호가창, 세션, 랭킹 캐시 |
| Kafka | 서비스 간 이벤트 메시징 |
| Elasticsearch | 뉴스 검색, 로그 검색 |
| Logstash + Kibana | 로그 수집, 모니터링 대시보드 |

### 9.4 Kafka Topics

| Topic | Producer | Consumer | 설명 |
|-------|----------|----------|------|
| order.created | Trading | Stock | 주문 생성 |
| order.matched | Stock | Trading, Season | 체결 완료 |
| price.updated | Stock | Frontend(WS) | 시세 변동 |
| event.occurred | Event | Stock, News | 이벤트 발생 |
| news.created | News | Frontend(WS) | 뉴스 생성 |
| schedule.trade | Scheduler | Trading | NPC 자동매매 |
| ranking.updated | Season | Frontend(WS) | 랭킹 갱신 |

---

## 10. 프론트엔드 (SvelteKit)

### 10.1 페이지 구성

| 페이지 | 주요 기능 |
|--------|----------|
| Dashboard | 시장 현황, 등락률 TOP, 거래량 TOP, 게임 시간 |
| News | 뉴스 피드, 검색, 필터 (레벨/산업) |
| 주식투자 | 종목 목록, 검색, 상세(차트/호가창), 매수/매도 |
| 마이페이지 | 포트폴리오, 자산 현황, 거래 내역 |
| 랭킹 | 실시간 랭킹, 시즌 히스토리 |

### 10.2 실시간 기능 (WebSocket)

| 기능 | 설명 |
|------|------|
| 시세 업데이트 | 실시간 주가 변동 |
| 호가창 업데이트 | 실시간 호가 변동 |
| 뉴스 알림 | 새 이벤트/뉴스 푸시 |
| 랭킹 업데이트 | 순위 변동 |

### 10.3 차트

| 항목 | 내용 |
|------|------|
| 캔들 주기 | 1분봉 |
| 저장 기간 | 시즌 전체 |
| 표시 지표 | 가격, 거래량 (추후 확장 가능) |

---

## 11. 기술 스택 요약

| 레이어 | 기술 |
|--------|------|
| Backend Language | Kotlin |
| Backend Framework | Spring Boot 3.x |
| Architecture | 헥사고날 + MSA |
| Service Discovery | Eureka |
| API Gateway | Spring Cloud Gateway |
| Database | PostgreSQL, MongoDB |
| Cache | Redis |
| Messaging | Kafka |
| Search | Elasticsearch |
| Logging | ELK Stack |
| Frontend | SvelteKit |
| Real-time | WebSocket |
| AI (추후) | Kotlin 기반 서빙 |

---

## 12. 향후 계획

### 12.1 다음 단계

1. ERD 설계 - 각 서비스별 테이블 구조
2. API 명세 - 엔드포인트 정의
3. 개발 로드맵 - 우선순위 및 마일스톤
4. 프로젝트 셋업 - 멀티모듈 구조, 공통 설정

### 12.2 미확정 사항

- 프로젝트명
- 시즌 기간
- AI 서빙 상세 구현

---

*문서 버전: v1.0*  
*최종 수정일: 2025년 1월*
