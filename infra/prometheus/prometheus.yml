global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # =============================================================================
  # Prometheus Self-Monitoring
  # =============================================================================
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # =============================================================================
  # Backend Microservices (Active)
  # =============================================================================

  # Eureka Server
  - job_name: 'eureka-server'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['eureka-server:8761']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'eureka-server'

  # API Gateway
  - job_name: 'api-gateway'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['api-gateway:8080']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'api-gateway'

  # User Service
  - job_name: 'user-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['user-service:8081']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'user-service'

  # Stock Service
  - job_name: 'stock-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['stock-service:8082']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'stock-service'

  # Trading Service
  - job_name: 'trading-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['trading-service:8083']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'trading-service'

  # Event Service
  - job_name: 'event-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['event-service:8084']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'event-service'

  # Scheduler Service
  - job_name: 'scheduler-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['scheduler-service:8085']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'scheduler-service'

  # News Service
  - job_name: 'news-service'
    metrics_path: '/actuator/prometheus'
    static_configs:
      - targets: ['news-service:8086']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'news-service'

  # =============================================================================
  # Frontend
  # =============================================================================
  - job_name: 'frontend'
    metrics_path: '/metrics'
    static_configs:
      - targets: ['frontend:8080']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'frontend'

  # =============================================================================
  # Infrastructure Exporters
  # =============================================================================
  
  # PostgreSQL Exporter
  - job_name: 'postgres-exporter'
    static_configs:
      - targets: ['postgres-exporter:9187']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'postgres-primary'

  # Redis Exporter
  - job_name: 'redis-exporter'
    static_configs:
      - targets: ['redis-exporter:9121']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'redis'

  # MongoDB Exporter
  - job_name: 'mongodb-exporter'
    static_configs:
      - targets: ['mongodb-exporter:9216']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'mongodb'

  # Kafka Exporter
  - job_name: 'kafka-exporter'
    static_configs:
      - targets: ['kafka-exporter:9308']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'kafka'

  # Elasticsearch Exporter
  - job_name: 'elasticsearch-exporter'
    static_configs:
      - targets: ['elasticsearch-exporter:9114']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'elasticsearch'

  # Node Exporter (Host Metrics)
  - job_name: 'node-exporter'
    static_configs:
      - targets: ['node-exporter:9100']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'docker-host'

  # cAdvisor (Container Metrics)
  - job_name: 'cadvisor'
    static_configs:
      - targets: ['cadvisor:8080']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'docker-containers'
